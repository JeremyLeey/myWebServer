# 项目目的
&emsp;学习Linux下C++编程,C++网络编程等知识点,增加项目经验
# 项目缘由
&emsp;18.11~18年底阅读陈硕的《Linux多线程服务端编程》(后面提到的书都是指该书)，结合相应的源码,对整个网络库的设计思想，整体架构有了一个大致的了解。
这里有一个参考Blog：[muduo网络库源码阅读Step by Step](https://baozh.github.io/2015-11/muduo-source-code-step-by-step/)
&emsp;后续在刷别人的C++后台面经时看到不少人也是阅读过muduo然后仿其自行实现的,于是决定自己也照着写一个加深理解。
# 项目设计框架个人总结
&emsp;同muduo采用non-blocking io + IO multiplexing,即Reactor模式,其中IO多路复用直接采用EPOLL。设计思想为one loop per thread,
即每个线程只有一个EventLoop事件循环,TcpServer所在线程为主线程,监听新连接到来,每当新连接到来,从线程池中取出下一可用线程,该线程内的EventLoop
负责监听该连接上之后的数据传输。
# 项目遇到的困难
&emsp;万事开头难,如果阅读过muduo源码的就知道,muduo网络库的设计用到了其设计base库,里面包括线程,锁,条件变量,时间戳,日志库的封装,如果上来直接
按照其网络部分开始写那么代码里用到各种base库的东西你就不知道该怎么办。因此,需要从base库开始,但base库内容庞大,对于刚开始的我来说更是不知如何下手。
这里结合自己当时的情况,给大家一个设计思路,希望能帮助到大家。
## 从0到1写一个线程池
&emsp;当时就先写一个线程池入手,这一部分可以先阅读书本的第2章，结合网上关于线程池的博客,就可以实现一个基于阻塞队列的线程池。设计思想是起初线程池
里的线程都睡在了条件变量wait处,一旦有任务到来,就唤醒条件变量,然后唤醒一个线程,去任务队列中取出任务去完成即可。从而完成了Thread类,MutexLock类,
Condition类的设计。
## 日志库的设计与整体分离
&emsp;muduo的日志库算是base库里面最重要也最复杂的内容了。但是幸运的是在网络库部分的设计中我可以暂时用std::cout去代替各种LOG打印,从而注重于
网络部分业务的实现。而关于日志库的设计可以参考书本第5章。
## 开始设计网络库
&emsp;大致有了一些底之后,就可以阅读书本第8章，一边读一边照着写。这里当时犯的一个错误就是没有注重测试用例的编写,导致最后在编译的时候遇到了各种各样
的问题(因为基本是用vim写的)，所以我建议就按照书本第8章的介绍来写,同时测试用例也都要写并编译测试！
## 网络库部分怎么设计?
&emsp;EventLoop,Epoll,Channel这三个类是息息相关,其中Channel是对文件描述符的封装；对这三个类的理解程度影响到后面网络部分的设计。因此建议首先着重
理解这三个类的设计与作用。  
&emsp;TcpServer与TcpConnection的设计。这一部分就直接涉及到网络部分了,阅读源码的过程中我建议是先怎么简单怎么来,包括我在读源码的时候也有很多地方
不明白为什么要这样做,所以我干脆就不写这部分,当然肯定会出现什么问题,但这对于刚开始写网络库的完全不需要在意，大体框架能写出来就ok。  
&emsp;最后就是功能的设计流程,我当时是这么干的,先写好连接建立和断开这一部分逻辑,至于错误处理什么的先放在一边,然后处理发送与接收数据流程。然后基于此
写个echo Server多线程试验一下,能够成功就说明大致的设计流程都没有问题了，剩下的就是一些细节的考虑。
# 项目ing
&emsp;2019.4.26 跟我参考的几位github上的网络库比,我自己这个实在时low到不行,还有很多很多要做的功能,现在想po上来只是因为他终于能运行了(捂脸)。
